# load packages
library(dplyr)
library(modelsummary)
library(grf)
# set seed for reproducibility
set.seed(42)
# read in the data
data <- read.csv("analysis_data.csv")
setwd("~/Dept of Methodology Dropbox/Zachary Dickson/joint projects Murat & Zach/covid_congress_PolComm_revision/replication_material")
# read in the data
data <- read.csv("analysis_data.csv")
# move the two senators (sanders king) and who caucus with the Democrats to the Democratic party (per reviewer 3)
data[data$party == 'Independent', 'party'] = 'Democrat'
# convert string variables to numeric for analysis
data$entity_id = as.numeric(as.factor(data$entity_id))
data$Republican = as.numeric(data$party == 'Republican')
data$Male = as.numeric(data$gender == 'M')
data$Age = as.numeric(data$MC_birth_year)
data['Total tweets'] = data['total_tweets']
# create vectors for each variable of interest
Y1_tweets <- data$opposition_tweet_count
W = data$treatment
X = data[c('Republican', 'Male', 'Total tweets', 'Age')]
# estimate the CATE using causal forests
cf1 <- causal_forest(X, Y1_tweets, W, W.hat = 0.5, clusters = entity_id, num.trees = 5000)
entity_id_int = as.numeric(as.factor(data$entity_id))
# estimate the CATE using causal forests
cf1 <- causal_forest(X, Y1_tweets, W, W.hat = 0.5, clusters = entity_id, num.trees = 5000)
# estimate the CATE using causal forests
cf1 <- causal_forest(X, Y1_tweets, W, W.hat = 0.5, clusters = entity_id_int, num.trees = 5000)
# get the variable importance
varimp_tweets <- variable_importance(cf1)
ranked.vars <- order(varimp_tweets, decreasing = TRUE)
# Top 4 variables according to this measure
colnames(X)[ranked.vars[1:4]]
# estimate the CATE using the top 4 variables
results_tweets = best_linear_projection(cf1, X[ranked.vars[1:4]])
# create a list of the results with the name of the model
models <- list('Opposition Tweets'= results_tweets)
## save the results to a table (Table A2)
modelsummary(models,
fmt = 4,
coef_omit = "Intercept",
stars = TRUE,
digits = 3)
# create a LaTeX table
kable(results,
format = "latex",
coef_omit = "Intercept",
booktabs = TRUE,
caption = "CATE Estimates for the effect of Infection on Opposition",
digits = 3,
align = "c",
col.names = c("CATE: Infection -> Opposition Tweets"),
caption.placement = "top") %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
footnote(general = "Standard errors are presented in parentheses.")
# create a LaTeX table
kable(results,
format = "latex",
coef_omit = "Intercept",
booktabs = TRUE,
caption = "CATE Estimates for the effect of Infection on Opposition",
digits = 3,
align = "c",
col.names = c("CATE: Infection -> Opposition Tweets"),
caption.placement = "top") %>%
kable_styling(latex_options = c("hold_position", "scale_down"))
library(kableExtra)
# create a LaTeX table
kable(results,
format = "latex",
coef_omit = "Intercept",
booktabs = TRUE,
caption = "CATE Estimates for the effect of Infection on Opposition",
digits = 3,
align = "c",
col.names = c("CATE: Infection -> Opposition Tweets"),
caption.placement = "top") %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
footnote(general = "Standard errors are presented in parentheses.")
# create a LaTeX table
kable(models,
format = "latex",
coef_omit = "Intercept",
booktabs = TRUE,
caption = "CATE Estimates for the effect of Infection on Opposition",
digits = 3,
align = "c",
col.names = c("CATE: Infection -> Opposition Tweets"),
caption.placement = "top") %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
footnote(general = "Standard errors are presented in parentheses.")
# create a LaTeX table
kable(models,
format = "latex",
coef_omit = "Intercept",
booktabs = TRUE,
caption = "CATE Estimates for the effect of Infection on Opposition",
digits = 3,
align = "c",
col.names = c("CATE: Infection -> Opposition Tweets"),
caption.placement = "top") %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
footnote(general = "Standard errors are presented in parentheses.")
# create a LaTeX table
kable(results_tweets,
format = "latex",
coef_omit = "Intercept",
booktabs = TRUE,
caption = "CATE Estimates for the effect of Infection on Opposition",
digits = 3,
align = "c",
col.names = c("CATE: Infection -> Opposition Tweets"),
caption.placement = "top") %>%
kable_styling(latex_options = c("hold_position", "scale_down")) %>%
footnote(general = "Standard errors are presented in parentheses.")
## save the results to a table (Table A2)
modelsummary(models,
fmt = 4,
coef_omit = "Intercept",
stars = TRUE,
digits = 3)
## save the results to a table (Table A2)
modelsummary(models,
fmt = 4,
coef_omit = "Intercept",
stars = TRUE,
digits = 3)
## save the results to a table (Table A2)
modelsummary(models,
fmt = 4,
coef_omit = "Intercept",
stars = TRUE,
digits = 3) %>%
save_kable(file = "test.tex")
## save the results to a table (Table A2)
modelsummary(models,
fmt = 4,
coef_omit = "Intercept",
stars = TRUE,
digits = 3) %>% save_kable(file = "test.tex")
## save the results to a table (Table A2)
modelsummary(models,
fmt = 4,
coef_omit = "Intercept",
stars = TRUE,
digits = 3,
output = "test.tex")
kable(models)
